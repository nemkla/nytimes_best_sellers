{"ast":null,"code":"var _jsxFileName = \"/Users/knemeth/React/nytimes_best_sellers/src/components/SearchBooks.js\";\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { connect } from 'react-redux';\nimport BookList from \"./BookList\";\nimport CategoryForm from \"./CategoryForm\";\nimport \"../styles/SearchBooks.css\";\n\nfunction SearchBooks() {\n  const URL = \"https://api.nytimes.com/svc/books/v3/lists/names.json?api-key=OGDK7aGVDlAT6L8KaYnfASlYi6ydHveG\";\n  const [url, setUrl] = useState(URL);\n  useEffect(() => {\n    async function fetchData() {\n      try {\n        let didCancel = false;\n\n        const fetchData = async () => {\n          let init = url === URL ? doFetchInitCategory() : doFetchInitBook();\n          let failure = url === URL ? doFetchFailureCategory() : doFetchFailureBook();\n          init();\n\n          try {\n            const response = await fetch(url);\n\n            if (!response.ok) {\n              throw Error(response.statusText);\n            }\n\n            const data = await response.json();\n\n            if (!didCancel) {\n              let success = url === URL ? doFetchSuccessCategory(data.results) : doFetchSuccessBook(data.results.books);\n              success();\n            }\n          } catch (error) {\n            if (!didCancel) {\n              failure();\n            }\n          }\n        };\n\n        fetchData();\n        return () => {\n          didCancel = true;\n        };\n      } catch (error) {\n        console.error(error);\n      }\n    }\n\n    fetchData();\n  }, [url]);\n\n  const handleOnSubmit = event => {\n    event.preventDefault();\n    categories.selected !== \"\" ? setUrl(`https://api.nytimes.com/svc/books/v3/lists/current/${categories.selected}.json?api-key=OGDK7aGVDlAT6L8KaYnfASlYi6ydHveG`) : alert(\"Category cannot be empty!!!\");\n  };\n\n  const handleOnChange = name => doSelectCategory(name);\n\n  const withMaybe = conditionalRenderingFn => Component => props => conditionalRenderingFn(props) ? null : /*#__PURE__*/React.createElement(Component, Object.assign({}, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }\n  }));\n\n  const withEither = (conditionalRenderingFn, EitherComponent) => Component => props => conditionalRenderingFn(props) ? /*#__PURE__*/React.createElement(EitherComponent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 9\n    }\n  }) : /*#__PURE__*/React.createElement(Component, Object.assign({}, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }));\n\n  const LoadingIndicator = () => /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 34\n    }\n  }, \"Loading ...\");\n\n  const ErrorMessage = () => /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 30\n    }\n  }, \"Oops, something went wrong ...\");\n\n  const EmptyMessage = () => /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 30\n    }\n  }, \"No Data Available ...\");\n\n  const isLoadingConditionFunction = props => props.isLoading;\n\n  const isErrorConditionFunction = props => props.isError;\n\n  const isNullConditionFunction = props => !props.data;\n\n  const isEmptyConditionFunction = props => !props.data.length;\n\n  const withConditionalRenderings = compose(withEither(isLoadingConditionFunction, LoadingIndicator), withEither(isErrorConditionFunction, ErrorMessage), withMaybe(isNullConditionFunction), withEither(isEmptyConditionFunction, EmptyMessage));\n  const FormWithConditionalRendering = withConditionalRenderings(CategoryForm);\n  const BookListWithConditionalRendering = withConditionalRenderings(BookList);\n  console.log('Render: SearchBooks');\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(FormWithConditionalRendering, Object.assign({}, categories, {\n    handleOnSubmit: handleOnSubmit,\n    handleOnChange: handleOnChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }\n  })), /*#__PURE__*/React.createElement(BookListWithConditionalRendering, Object.assign({}, books, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }\n  })));\n}\n\nconst mapStateToProps = ({\n  bookState,\n  categoryState\n}) => ({\n  books: bookState,\n  categories: categoryState\n});\n\nconst mapDispatchToProps = dispatch => ({\n  doSelectCategory: query => dispatch(doSelectCategory(query)),\n  doFetchInitCategory: query => dispatch(doFetchInitCategory(query)),\n  doFetchSuccessCategory: query => dispatch(doFetchSuccessCategory(query)),\n  doFetchFailureCategory: query => dispatch(doFetchFailureCategory(query)),\n  doFetchInitBook: query => dispatch(doFetchInitBook(query)),\n  doFetchSuccessBook: query => dispatch(doFetchSuccessBook(query)),\n  doFetchFailureBook: query => dispatch(doFetchFailureBook(query)),\n  doDeleteBook: query => dispatch(doDeleteBook(query)),\n  doSelectBook: query => dispatch(doSelectBook(query)),\n  doUnSelectBook: query => dispatch(doUnSelectBook(query))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SearchBooks);","map":{"version":3,"sources":["/Users/knemeth/React/nytimes_best_sellers/src/components/SearchBooks.js"],"names":["React","useState","useEffect","useContext","connect","BookList","CategoryForm","SearchBooks","URL","url","setUrl","fetchData","didCancel","init","doFetchInitCategory","doFetchInitBook","failure","doFetchFailureCategory","doFetchFailureBook","response","fetch","ok","Error","statusText","data","json","success","doFetchSuccessCategory","results","doFetchSuccessBook","books","error","console","handleOnSubmit","event","preventDefault","categories","selected","alert","handleOnChange","name","doSelectCategory","withMaybe","conditionalRenderingFn","Component","props","withEither","EitherComponent","LoadingIndicator","ErrorMessage","EmptyMessage","isLoadingConditionFunction","isLoading","isErrorConditionFunction","isError","isNullConditionFunction","isEmptyConditionFunction","length","withConditionalRenderings","compose","FormWithConditionalRendering","BookListWithConditionalRendering","log","mapStateToProps","bookState","categoryState","mapDispatchToProps","dispatch","query","doDeleteBook","doSelectBook","doUnSelectBook"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,UAArC,QAAuD,OAAvD;AACA,SAASC,OAAT,QAAwB,aAAxB;AAEA,OAAOC,QAAP,MAAqB,YAArB;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AAEA,OAAO,2BAAP;;AAEA,SAASC,WAAT,GAAuB;AACrB,QAAMC,GAAG,GACP,gGADF;AAEA,QAAM,CAACC,GAAD,EAAMC,MAAN,IAAgBT,QAAQ,CAACO,GAAD,CAA9B;AAEAN,EAAAA,SAAS,CAAC,MAAM;AACd,mBAAeS,SAAf,GAA2B;AACzB,UAAI;AACF,YAAIC,SAAS,GAAG,KAAhB;;AACA,cAAMD,SAAS,GAAG,YAAY;AAC5B,cAAIE,IAAI,GACNJ,GAAG,KAAKD,GAAR,GACIM,mBAAmB,EADvB,GAEIC,eAAe,EAHrB;AAIA,cAAIC,OAAO,GACTP,GAAG,KAAKD,GAAR,GACIS,sBAAsB,EAD1B,GAEIC,kBAAkB,EAHxB;AAKAL,UAAAA,IAAI;;AACJ,cAAI;AACF,kBAAMM,QAAQ,GAAG,MAAMC,KAAK,CAACX,GAAD,CAA5B;;AACA,gBAAI,CAACU,QAAQ,CAACE,EAAd,EAAkB;AAChB,oBAAMC,KAAK,CAACH,QAAQ,CAACI,UAAV,CAAX;AACD;;AACD,kBAAMC,IAAI,GAAG,MAAML,QAAQ,CAACM,IAAT,EAAnB;;AAEA,gBAAI,CAACb,SAAL,EAAgB;AACd,kBAAIc,OAAO,GACTjB,GAAG,KAAKD,GAAR,GACImB,sBAAsB,CAACH,IAAI,CAACI,OAAN,CAD1B,GAEIC,kBAAkB,CAACL,IAAI,CAACI,OAAL,CAAaE,KAAd,CAHxB;AAKFJ,cAAAA,OAAO;AACN;AACF,WAfD,CAeE,OAAOK,KAAP,EAAc;AACd,gBAAI,CAACnB,SAAL,EAAgB;AACdI,cAAAA,OAAO;AACR;AACF;AACF,SA/BD;;AAiCAL,QAAAA,SAAS;AACT,eAAO,MAAM;AACXC,UAAAA,SAAS,GAAG,IAAZ;AACD,SAFD;AAGD,OAvCD,CAuCE,OAAOmB,KAAP,EAAc;AACdC,QAAAA,OAAO,CAACD,KAAR,CAAcA,KAAd;AACD;AACF;;AACDpB,IAAAA,SAAS;AACV,GA9CQ,EA8CN,CAACF,GAAD,CA9CM,CAAT;;AAgDA,QAAMwB,cAAc,GAAIC,KAAD,IAAW;AAChCA,IAAAA,KAAK,CAACC,cAAN;AACAC,IAAAA,UAAU,CAACC,QAAX,KAAwB,EAAxB,GACI3B,MAAM,CACH,sDAAqD0B,UAAU,CAACC,QAAS,gDADtE,CADV,GAIIC,KAAK,CAAC,6BAAD,CAJT;AAKD,GAPD;;AASA,QAAMC,cAAc,GAAIC,IAAD,IAAUC,gBAAgB,CAACD,IAAD,CAAjD;;AAEA,QAAME,SAAS,GAAIC,sBAAD,IAA6BC,SAAD,IAAgBC,KAAD,IAC3DF,sBAAsB,CAACE,KAAD,CAAtB,GACI,IADJ,gBAEI,oBAAC,SAAD,oBAAgBA,KAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAHN;;AAKA,QAAMC,UAAU,GAAG,CAACH,sBAAD,EAAyBI,eAAzB,KAA8CH,SAAD,IAAgBC,KAAD,IAC7EF,sBAAsB,CAACE,KAAD,CAAtB,gBACI,oBAAC,eAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,gBAEI,oBAAC,SAAD,oBAAgBA,KAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAHN;;AAKA,QAAMG,gBAAgB,GAAG,mBAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAA/B;;AACA,QAAMC,YAAY,GAAG,mBAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sCAA3B;;AACA,QAAMC,YAAY,GAAG,mBAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BAA3B;;AAEA,QAAMC,0BAA0B,GAAIN,KAAD,IAAWA,KAAK,CAACO,SAApD;;AACA,QAAMC,wBAAwB,GAAIR,KAAD,IAAWA,KAAK,CAACS,OAAlD;;AACA,QAAMC,uBAAuB,GAAIV,KAAD,IAAW,CAACA,KAAK,CAACrB,IAAlD;;AACA,QAAMgC,wBAAwB,GAAIX,KAAD,IAAW,CAACA,KAAK,CAACrB,IAAN,CAAWiC,MAAxD;;AAEA,QAAMC,yBAAyB,GAAGC,OAAO,CACzCb,UAAU,CAACK,0BAAD,EAA6BH,gBAA7B,CAD+B,EAEzCF,UAAU,CAACO,wBAAD,EAA2BJ,YAA3B,CAF+B,EAGzCP,SAAS,CAACa,uBAAD,CAHgC,EAIzCT,UAAU,CAACU,wBAAD,EAA2BN,YAA3B,CAJ+B,CAAzC;AAMA,QAAMU,4BAA4B,GAAGF,yBAAyB,CAACpD,YAAD,CAA9D;AACA,QAAMuD,gCAAgC,GAAGH,yBAAyB,CAACrD,QAAD,CAAlE;AAEA2B,EAAAA,OAAO,CAAC8B,GAAR,CAAY,qBAAZ;AACA,sBACE,uDACE,oBAAC,4BAAD,oBAAmC1B,UAAnC;AAAgD,IAAA,cAAc,EAAEH,cAAhE;AAAgF,IAAA,cAAc,EAAEM,cAAhG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADF,eAEE,oBAAC,gCAAD,oBAAwCT,KAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAFF,CADF;AAMD;;AAED,MAAMiC,eAAe,GAAG,CAAC;AAACC,EAAAA,SAAD;AAAYC,EAAAA;AAAZ,CAAD,MAAiC;AACvDnC,EAAAA,KAAK,EAAEkC,SADgD;AAEvD5B,EAAAA,UAAU,EAAE6B;AAF2C,CAAjC,CAAxB;;AAKA,MAAMC,kBAAkB,GAAIC,QAAD,KAAe;AACxC1B,EAAAA,gBAAgB,EAAE2B,KAAK,IAAID,QAAQ,CAAC1B,gBAAgB,CAAC2B,KAAD,CAAjB,CADK;AAExCtD,EAAAA,mBAAmB,EAAEsD,KAAK,IAAID,QAAQ,CAACrD,mBAAmB,CAACsD,KAAD,CAApB,CAFE;AAGxCzC,EAAAA,sBAAsB,EAAEyC,KAAK,IAAID,QAAQ,CAACxC,sBAAsB,CAACyC,KAAD,CAAvB,CAHD;AAIxCnD,EAAAA,sBAAsB,EAAEmD,KAAK,IAAID,QAAQ,CAAClD,sBAAsB,CAACmD,KAAD,CAAvB,CAJD;AAKxCrD,EAAAA,eAAe,EAAEqD,KAAK,IAAID,QAAQ,CAACpD,eAAe,CAACqD,KAAD,CAAhB,CALM;AAMxCvC,EAAAA,kBAAkB,EAAEuC,KAAK,IAAID,QAAQ,CAACtC,kBAAkB,CAACuC,KAAD,CAAnB,CANG;AAOxClD,EAAAA,kBAAkB,EAAEkD,KAAK,IAAID,QAAQ,CAACjD,kBAAkB,CAACkD,KAAD,CAAnB,CAPG;AAQxCC,EAAAA,YAAY,EAAED,KAAK,IAAID,QAAQ,CAACE,YAAY,CAACD,KAAD,CAAb,CARS;AASxCE,EAAAA,YAAY,EAAEF,KAAK,IAAID,QAAQ,CAACG,YAAY,CAACF,KAAD,CAAb,CATS;AAUxCG,EAAAA,cAAc,EAAEH,KAAK,IAAID,QAAQ,CAACI,cAAc,CAACH,KAAD,CAAf;AAVO,CAAf,CAA3B;;AAaA,eAAehE,OAAO,CACpB2D,eADoB,EAEpBG,kBAFoB,CAAP,CAGb3D,WAHa,CAAf","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\nimport { connect } from 'react-redux';\n\nimport BookList from \"./BookList\";\nimport CategoryForm from \"./CategoryForm\";\n\nimport \"../styles/SearchBooks.css\";\n\nfunction SearchBooks() {\n  const URL =\n    \"https://api.nytimes.com/svc/books/v3/lists/names.json?api-key=OGDK7aGVDlAT6L8KaYnfASlYi6ydHveG\";\n  const [url, setUrl] = useState(URL);\n\n  useEffect(() => {\n    async function fetchData() {\n      try {\n        let didCancel = false;\n        const fetchData = async () => {\n          let init =\n            url === URL\n              ? doFetchInitCategory()\n              : doFetchInitBook();\n          let failure =\n            url === URL\n              ? doFetchFailureCategory()\n              : doFetchFailureBook();\n\n          init();\n          try {\n            const response = await fetch(url);\n            if (!response.ok) {\n              throw Error(response.statusText);\n            }\n            const data = await response.json();\n\n            if (!didCancel) {\n              let success =\n                url === URL\n                  ? doFetchSuccessCategory(data.results)\n                  : doFetchSuccessBook(data.results.books);\n\n            success();\n            }\n          } catch (error) {\n            if (!didCancel) {\n              failure();\n            }\n          }\n        };\n\n        fetchData();\n        return () => {\n          didCancel = true;\n        };\n      } catch (error) {\n        console.error(error);\n      }\n    }\n    fetchData();\n  }, [url]);\n\n  const handleOnSubmit = (event) => {\n    event.preventDefault();\n    categories.selected !== \"\"\n      ? setUrl(\n          `https://api.nytimes.com/svc/books/v3/lists/current/${categories.selected}.json?api-key=OGDK7aGVDlAT6L8KaYnfASlYi6ydHveG`\n        )\n      : alert(\"Category cannot be empty!!!\");\n  };\n\n  const handleOnChange = (name) => doSelectCategory(name);\n\n  const withMaybe = (conditionalRenderingFn) => (Component) => (props) =>\n    conditionalRenderingFn(props)\n      ? null\n      : <Component { ...props } />\n\n  const withEither = (conditionalRenderingFn, EitherComponent) => (Component) => (props) =>\n    conditionalRenderingFn(props)\n      ? <EitherComponent />\n      : <Component { ...props } />\n\n  const LoadingIndicator = () => <p>Loading ...</p>;\n  const ErrorMessage = () => <p>Oops, something went wrong ...</p>;\n  const EmptyMessage = () => <p>No Data Available ...</p>;\n\n  const isLoadingConditionFunction = (props) => props.isLoading;\n  const isErrorConditionFunction = (props) => props.isError;\n  const isNullConditionFunction = (props) => !props.data;\n  const isEmptyConditionFunction = (props) => !props.data.length;\n\n  const withConditionalRenderings = compose(\n  withEither(isLoadingConditionFunction, LoadingIndicator),\n  withEither(isErrorConditionFunction, ErrorMessage),\n  withMaybe(isNullConditionFunction),\n  withEither(isEmptyConditionFunction, EmptyMessage));\n\n  const FormWithConditionalRendering = withConditionalRenderings(CategoryForm);\n  const BookListWithConditionalRendering = withConditionalRenderings(BookList);\n\n  console.log('Render: SearchBooks');\n  return (\n    <>\n      <FormWithConditionalRendering { ...categories } handleOnSubmit={handleOnSubmit} handleOnChange={handleOnChange} />\n      <BookListWithConditionalRendering  { ...books } />\n    </>\n  );\n}\n\nconst mapStateToProps = ({bookState, categoryState}) => ({\n  books: bookState,\n  categories: categoryState\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  doSelectCategory: query => dispatch(doSelectCategory(query)),\n  doFetchInitCategory: query => dispatch(doFetchInitCategory(query)),\n  doFetchSuccessCategory: query => dispatch(doFetchSuccessCategory(query)),\n  doFetchFailureCategory: query => dispatch(doFetchFailureCategory(query)),\n  doFetchInitBook: query => dispatch(doFetchInitBook(query)),\n  doFetchSuccessBook: query => dispatch(doFetchSuccessBook(query)),\n  doFetchFailureBook: query => dispatch(doFetchFailureBook(query)),\n  doDeleteBook: query => dispatch(doDeleteBook(query)),\n  doSelectBook: query => dispatch(doSelectBook(query)),\n  doUnSelectBook: query => dispatch(doUnSelectBook(query))\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(SearchBooks);\n"]},"metadata":{},"sourceType":"module"}