{"ast":null,"code":"var _jsxFileName = \"/Users/knemeth/React/nytimes_best_sellers/src/components/SearchBooks.js\";\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { connect } from \"react-redux\";\nimport { compose } from \"recompose\";\nimport { doFetchInitBook, doFetchSuccessBook, doFetchFailureBook, doDeleteBook, doSelectBook, doUnSelectBook } from \"../action/book\";\nimport BookList from \"./BookList\";\nimport CategoryForm from \"./CategoryForm\";\nimport \"../styles/SearchBooks.css\";\n\nfunction SearchBooks({\n  books,\n  categories,\n  doSelectCategory,\n  doFetchInitCategory,\n  doFetchSuccessCategory,\n  doFetchFailureCategory,\n  doFetchInitBook,\n  doFetchSuccessBook,\n  doFetchFailureBook\n}) {\n  const URL = \"https://api.nytimes.com/svc/books/v3/lists/names.json?api-key=OGDK7aGVDlAT6L8KaYnfASlYi6ydHveG\";\n  const [url, setUrl] = useState(URL);\n  useEffect(() => {\n    async function fetchData() {\n      try {\n        let didCancel = false;\n\n        const fetchData = async () => {\n          let init = url === URL ? doFetchInitCategory() : doFetchInitBook();\n          let failure = url === URL ? doFetchFailureCategory() : doFetchFailureBook();\n          init();\n\n          try {\n            const response = await fetch(url);\n\n            if (!response.ok) {\n              throw Error(response.statusText);\n            }\n\n            const data = await response.json();\n\n            if (!didCancel) {\n              let success = url === URL ? doFetchSuccessCategory(data.results) : doFetchSuccessBook(data.results.books);\n              success();\n            }\n          } catch (error) {\n            if (!didCancel) {\n              failure();\n            }\n          }\n        };\n\n        fetchData();\n        return () => {\n          didCancel = true;\n        };\n      } catch (error) {\n        console.error(error);\n      }\n    }\n\n    fetchData();\n  }, [url]);\n\n  const handleOnSubmit = event => {\n    event.preventDefault();\n    categories.selected !== \"\" ? setUrl(`https://api.nytimes.com/svc/books/v3/lists/current/${categories.selected}.json?api-key=OGDK7aGVDlAT6L8KaYnfASlYi6ydHveG`) : alert(\"Category cannot be empty!!!\");\n  };\n\n  const handleOnChange = name => doSelectCategory(name);\n\n  const withMaybe = conditionalRenderingFn => Component => props => conditionalRenderingFn(props) ? null : /*#__PURE__*/React.createElement(Component, Object.assign({}, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }\n  }));\n\n  const withEither = (conditionalRenderingFn, EitherComponent) => Component => props => conditionalRenderingFn(props) ? /*#__PURE__*/React.createElement(EitherComponent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }) : /*#__PURE__*/React.createElement(Component, Object.assign({}, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }\n  }));\n\n  const LoadingIndicator = () => /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 34\n    }\n  }, \"Loading ...\");\n\n  const ErrorMessage = () => /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 30\n    }\n  }, \"Oops, something went wrong ...\");\n\n  const EmptyMessage = () => /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 30\n    }\n  }, \"No Data Available ...\");\n\n  const isLoadingConditionFunction = props => props.isLoading;\n\n  const isErrorConditionFunction = props => props.isError;\n\n  const isNullConditionFunction = props => !props.data;\n\n  const isEmptyConditionFunction = props => !props.data.length;\n\n  const withConditionalRenderings = compose(withEither(isLoadingConditionFunction, LoadingIndicator), withEither(isErrorConditionFunction, ErrorMessage), withMaybe(isNullConditionFunction), withEither(isEmptyConditionFunction, EmptyMessage));\n  const FormWithConditionalRendering = withConditionalRenderings(CategoryForm);\n  const BookListWithConditionalRendering = withConditionalRenderings(BookList);\n  console.log('Render: SearchBooks');\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(FormWithConditionalRendering, Object.assign({}, categories, {\n    handleOnSubmit: handleOnSubmit,\n    handleOnChange: handleOnChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }\n  })), /*#__PURE__*/React.createElement(BookListWithConditionalRendering, Object.assign({}, books, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }\n  })));\n}\n\nconst mapStateToProps = ({\n  bookState,\n  categoryState\n}) => ({\n  books: bookState,\n  categories: categoryState\n});\n\nconst mapDispatchToProps = dispatch => ({\n  doSelectCategory: query => dispatch(doSelectCategory(query)),\n  doFetchInitCategory: query => dispatch(doFetchInitCategory(query)),\n  doFetchSuccessCategory: query => dispatch(doFetchSuccessCategory(query)),\n  doFetchFailureCategory: query => dispatch(doFetchFailureCategory(query)),\n  doFetchInitBook: query => dispatch(doFetchInitBook(query)),\n  doFetchSuccessBook: query => dispatch(doFetchSuccessBook(query)),\n  doFetchFailureBook: query => dispatch(doFetchFailureBook(query))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SearchBooks);","map":{"version":3,"sources":["/Users/knemeth/React/nytimes_best_sellers/src/components/SearchBooks.js"],"names":["React","useState","useEffect","useContext","connect","compose","doFetchInitBook","doFetchSuccessBook","doFetchFailureBook","doDeleteBook","doSelectBook","doUnSelectBook","BookList","CategoryForm","SearchBooks","books","categories","doSelectCategory","doFetchInitCategory","doFetchSuccessCategory","doFetchFailureCategory","URL","url","setUrl","fetchData","didCancel","init","failure","response","fetch","ok","Error","statusText","data","json","success","results","error","console","handleOnSubmit","event","preventDefault","selected","alert","handleOnChange","name","withMaybe","conditionalRenderingFn","Component","props","withEither","EitherComponent","LoadingIndicator","ErrorMessage","EmptyMessage","isLoadingConditionFunction","isLoading","isErrorConditionFunction","isError","isNullConditionFunction","isEmptyConditionFunction","length","withConditionalRenderings","FormWithConditionalRendering","BookListWithConditionalRendering","log","mapStateToProps","bookState","categoryState","mapDispatchToProps","dispatch","query"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\nimport { connect } from \"react-redux\";\nimport { compose } from \"recompose\";\nimport {\n  doFetchInitBook,\n  doFetchSuccessBook,\n  doFetchFailureBook,\n  doDeleteBook,\n  doSelectBook,\n  doUnSelectBook,\n} from \"../action/book\";\nimport BookList from \"./BookList\";\nimport CategoryForm from \"./CategoryForm\";\n\n\nimport \"../styles/SearchBooks.css\";\n\nfunction SearchBooks({books, categories, doSelectCategory, doFetchInitCategory, doFetchSuccessCategory, doFetchFailureCategory, doFetchInitBook, doFetchSuccessBook, doFetchFailureBook }) {\n  const URL =\n    \"https://api.nytimes.com/svc/books/v3/lists/names.json?api-key=OGDK7aGVDlAT6L8KaYnfASlYi6ydHveG\";\n  const [url, setUrl] = useState(URL);\n\n  useEffect(() => {\n    async function fetchData() {\n      try {\n        let didCancel = false;\n        const fetchData = async () => {\n          let init =\n            url === URL\n              ? doFetchInitCategory()\n              : doFetchInitBook();\n          let failure =\n            url === URL\n              ? doFetchFailureCategory()\n              : doFetchFailureBook();\n\n          init();\n          try {\n            const response = await fetch(url);\n            if (!response.ok) {\n              throw Error(response.statusText);\n            }\n            const data = await response.json();\n\n            if (!didCancel) {\n              let success =\n                url === URL\n                  ? doFetchSuccessCategory(data.results)\n                  : doFetchSuccessBook(data.results.books);\n\n            success();\n            }\n          } catch (error) {\n            if (!didCancel) {\n              failure();\n            }\n          }\n        };\n\n        fetchData();\n        return () => {\n          didCancel = true;\n        };\n      } catch (error) {\n        console.error(error);\n      }\n    }\n    fetchData();\n  }, [url]);\n\n  const handleOnSubmit = (event) => {\n    event.preventDefault();\n    categories.selected !== \"\"\n      ? setUrl(\n          `https://api.nytimes.com/svc/books/v3/lists/current/${categories.selected}.json?api-key=OGDK7aGVDlAT6L8KaYnfASlYi6ydHveG`\n        )\n      : alert(\"Category cannot be empty!!!\");\n  };\n\n  const handleOnChange = (name) => doSelectCategory(name);\n\n  const withMaybe = (conditionalRenderingFn) => (Component) => (props) =>\n    conditionalRenderingFn(props)\n      ? null\n      : <Component { ...props } />\n\n  const withEither = (conditionalRenderingFn, EitherComponent) => (Component) => (props) =>\n    conditionalRenderingFn(props)\n      ? <EitherComponent />\n      : <Component { ...props } />\n\n  const LoadingIndicator = () => <p>Loading ...</p>;\n  const ErrorMessage = () => <p>Oops, something went wrong ...</p>;\n  const EmptyMessage = () => <p>No Data Available ...</p>;\n\n  const isLoadingConditionFunction = (props) => props.isLoading;\n  const isErrorConditionFunction = (props) => props.isError;\n  const isNullConditionFunction = (props) => !props.data;\n  const isEmptyConditionFunction = (props) => !props.data.length;\n\n  const withConditionalRenderings = compose(\n  withEither(isLoadingConditionFunction, LoadingIndicator),\n  withEither(isErrorConditionFunction, ErrorMessage),\n  withMaybe(isNullConditionFunction),\n  withEither(isEmptyConditionFunction, EmptyMessage));\n\n  const FormWithConditionalRendering = withConditionalRenderings(CategoryForm);\n  const BookListWithConditionalRendering = withConditionalRenderings(BookList);\n\n  console.log('Render: SearchBooks');\n  return (\n    <>\n      <FormWithConditionalRendering { ...categories } handleOnSubmit={handleOnSubmit} handleOnChange={handleOnChange} />\n      <BookListWithConditionalRendering  { ...books } />\n    </>\n  );\n}\n\nconst mapStateToProps = ({bookState, categoryState}) => ({\n  books: bookState,\n  categories: categoryState\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  doSelectCategory: query => dispatch(doSelectCategory(query)),\n  doFetchInitCategory: query => dispatch(doFetchInitCategory(query)),\n  doFetchSuccessCategory: query => dispatch(doFetchSuccessCategory(query)),\n  doFetchFailureCategory: query => dispatch(doFetchFailureCategory(query)),\n  doFetchInitBook: query => dispatch(doFetchInitBook(query)),\n  doFetchSuccessBook: query => dispatch(doFetchSuccessBook(query)),\n  doFetchFailureBook: query => dispatch(doFetchFailureBook(query))\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(SearchBooks);\n"]},"metadata":{},"sourceType":"module"}